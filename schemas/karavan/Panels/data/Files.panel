{"panel":"1:\r\n<form action=\"upload/\"\r\nenctype=\"multipart/form-data\" method=\"post\">\r\n<p>\r\nType some text (if you like):<br>\r\n<input type=\"text\" name=\"textline\" size=\"30\">\r\n</p>\r\n<p>\r\nPlease specify a file, or a set of files:<br>\r\n<input type=\"file\" name=\"datafile\" size=\"40\">\r\n</p>\r\n<div>\r\n<input type=\"submit\" value=\"Send\">\r\n</div>\r\n</form>\r\n<br>\r\n\r\n2:\r\n<form action=\"upload/\" enctype=\"multipart/form-data\" method=\"post\">\r\n<input type=\"text\" name=\"title\"><br>\r\n<input type=\"file\" name=\"upload\" multiple=\"multiple\"><br>\r\n<input type=\"submit\" value=\"Upload\">\r\n</form>\r\n<br>\r\n\r\n3:\r\n<div class=\"input-group input-group-sm\">\r\n    <div class=\"input-group-btn\">\r\n        <button type=\"button\" class=\"btn btn-info\">Выбрать файл</button>\r\n    </div>\r\n    <input data-element=\"Fil\" type=\"file\" name=\"file\" style=\"display:none1\"/>\r\n</div>\r\n\r\n\r\n\r\n\r\n<br>\r\n\r\n<div data-element=\"Files\">\r\n    <form>\r\n        <input type=\"file\" name=\"file\" style=\"display:none1\"/>\r\n    </form>\r\n    <div class=\"input-group input-group-sm\">\r\n        <div class=\"input-group-btn\">\r\n            <button type=\"button\" class=\"btn btn-info\">Выбрать файл</button>\r\n        </div>\r\n        <input type=\"text\" class=\"form-control\" readonly>\r\n    </div>\r\n</div>\r\n<br>\r\n\r\n<button data-element=\"SendFile\" type=\"button\" class=\"btn btn-info\">Отправить файл</button>\r\n\r\n<br>\r\n\r\n\r\n        \r\n<!--input type=\"file\" name=\"files[]\"  data-url=\"/upload/\" multiple-->\r\n<br><br>\r\n<h4>Тест скачки файла</h4>\r\n<a href=\"/files/common/test.txt\">test.txt</a>\r\n\r\n\r\n<!-- \r\n<div data-element=\"Files\">\r\n    <input type=\"file\" name=\"file\" style=\"display:none1\"/>\r\n    <div class=\"input-group input-group-sm\">\r\n        <div class=\"input-group-btn\">\r\n            <button type=\"button\" class=\"btn btn-info\">Загрузить</button>\r\n            <button type=\"button\" class=\"btn btn-info dropdown-toggle\" data-toggle=\"dropdown\" aria-expanded=\"false\"><span class=\"fa fa-caret-down\"></span></button>\r\n            <ul class=\"dropdown-menu\">\r\n                <li><a href=\"#\"><span class=\"fa fa-file-o\"></span> Файл1</a></li>\r\n                <li><a href=\"#\"><span class=\"fa fa-file-o\"></span> Файл2</a></li>\r\n            </ul>\r\n        </div>\r\n        <input type=\"text\" class=\"form-control\" disabled>\r\n    </div>\r\n</div>\r\n\r\n\r\n\r\n-->","style":"","client":"function Unloader(){\n    var o = this;\n    this.unload = function(evt){\n        var message = \"Вы действительно хотите уйти со страницы?\";\n        if (typeof evt == \"undefined\") {\n            evt = window.event;\n        }\n        if (evt) {\n            evt.returnValue = message;\n        }\n        return message;\n    }\n \n    this.resetUnload = function()\n    {\n        $(window).off('beforeunload', o.unload);\n \n         setTimeout(function(){\n            $(window).on('beforeunload', o.unload);\n        }, 1000);\n    }\n \n    this.init = function()\n    {\n        $(window).on('beforeunload', o.unload);\n \n        $('a').on('click', o.resetUnload);\n        $(document).on('submit', 'form', o.resetUnload);\n      \n        // F5 и Ctrl+F5, Enter\n        $(document).on('keydown', function(event){\n        //    if((event.ctrlKey && event.keyCode == 116) || event.keyCode == 116 || event.keyCode == 13){\n        //        o.resetUnload();\n        //    }\n        });\n        \n    }\n    this.init();\n}\n\n\nfunction SetFileField(){\n    //var ul = $('#filelist');\n    //$('#drop a').click(function(){\n    //    // имитация нажатия на поле выбора файла\n    //    $(this).parent().find('input').click();\n    //});\n    \n    Elements.Files.find('button').on('click', function(e){\n        Elements.Files.find('input[type=\"file\"]').on('change', function(e){\n            console.log('onchange', e);\n            var file = $(this).val();\n            Elements.Files.find('input[type=\"text\"]').val(file); \n        }).trigger('click'); \n    });\n    /*\n    Elements.SendFile.on('click', function(e){\n        var dados = Elements.Files.find('form').serialize();\n        $.ajax({  \n            type: \"POST\",\n            //contentType:attr( \"enctype\", \"multipart/form-data\" ),\n            url: \"upload/\",  \n            data: dados,  \n            success: function( data ){  \n                alert( data );  \n            }  \n        });  \n        return false;\n    });\n    */\n    \n    /*\n    Elements.Files.fileupload({\n        dataType: 'json',\n        // этот элемент будет принимать перетаскиваемые на него файлы\n        //dropZone: $('#drop'),\n        // Функция будет вызвана при помещении файла в очередь\n        add: function (e, data) {\n            console.log('add', data);\n            var file = data.files[0];\n            data.context = Elements.Files.find('ul').append('<li><a href=\"#\"><span class=\"fa fa-file-o\"></span> '+file.name+' ('+file.size+')</a></li>');\n            data.submit();\n        },\n        done: function (e, data) {\n            console.log('done', data);\n            data.context.text('Upload finished.');\n        },\n        progress: function(e, data){\n            console.log('progress', data);\n            \n            // Вычисление процента загрузки\n            //var progress = parseInt(data.loaded / data.total * 100, 10);\n            // обновляем шкалу\n            //data.context.find('input').val(progress).change();\n            //if(progress == 100){\n            //    data.context.removeClass('working');\n            //}\n        },\n        fail:function(e, data){\n            console.log('fail', data);\n        }\n    });\n    */\n \n    /*\n    $(document).on('drop dragover', function (e) {\n        e.preventDefault();\n    });\n    */\n    \n    /*\n    // вспомогательная функция, которая форматирует размер файла\n    function formatFileSize(bytes) {\n        if (typeof bytes !== 'number') {\n            return '';\n        }\n        if (bytes >= 1000000000) {\n            return (bytes / 1000000000).toFixed(2) + ' GB';\n        }\n        if (bytes >= 1000000) {\n            return (bytes / 1000000).toFixed(2) + ' MB';\n        }\n        return (bytes / 1000).toFixed(2) + ' KB';\n    }  \n    */\n}\n\nfunction onInit(config){\n    Elements.Fil.w2field('file', {\n        //selected        : [],       // selected array\n        placeholder     : '',       // placeholde if empty\n        max             : 0,        // max number of selected items, 0 - unlim\n        maxSize         : 0,        // max size of all files, 0 - unlim\n        maxFileSize     : 0,        // max size of a single file, 0 -unlim\n        maxWidth        : 250,      // max width for a single item\n        maxHeight       : 350,      // max height for input control to grow\n        maxDropHeight   : 350,      // max height for drop down menu\n        silent          : true,     // indicates if to display error tag\n        renderItem      : null,     // render selected item\n        style           : 'form-control',       // style for container div\n        //onClick         : function(e){console.log('onClick',e);},     // when an item is clicked\n        //onAdd           : function(e){console.log('onAdd',e);},     // when an item is added\n        //onRemove        : function(e){console.log('onRemove',e);},     // when an item is removed\n        //onMouseOver     : function(e){console.log('onMouseOver',e);},     // when an item is mouse over\n        //onMouseOut      : function(e){console.log('onMouseOut',e);}      // when an item is mouse out);\n    });\n    \n    Elements.SendFile.on('click', function(e){\n        var dados = Elements.Fil.data('selected');\n        /*$.ajax({  \n            type: \"POST\",\n            //contentType:attr( \"enctype\", \"multipart/form-data\" ),\n            url: \"upload/\",  \n            data: dados,  \n            success: function( data ){  \n                alert( data );  \n            }  \n        }); */ \n        $.ajax({\n            type: \"POST\",\n            url: \"upload/\",\n            data: dados, \n            progress: function (e) {\n                if (e.lengthComputable) {\n                    console.log(e.loaded / e.total * 100 + '%');\n                }\n            },\n            success: function (response) {\n                alert( response ); \n            }\n        });\n        return false;\n    });\n    \n    \n    /*\n    if(typeof window.obUnloader !== 'object') {\n        window.obUnloader = new Unloader();\n    }\n    \n    $.when(\n        $.getScript(\"vendor/jQueryFileUpload/js/jquery.knob.js\"),\n        $.getScript(\"vendor/jQueryFileUpload/js/jquery.ui.widget.js\"),\n        $.getScript(\"vendor/jQueryFileUpload/js/jquery.iframe-transport.js\"),\n        $.getScript(\"vendor/jQueryFileUpload/js/jquery.fileupload.js\")\n    ).done(function(){\n        var ok, error;\n        for (var key in arguments) {\n            //console.log('LoadScript', key, arguments[key]);\n        }\n        SetFileField();\n    });\n    \n    */\n    \n    \n    \n    \n    \n    \n    /*\n    Elements.Upload.fileupload({\n        dataType: 'json',\n        progressall: function (e, data) {\n            var progress = parseInt(data.loaded / data.total * 100, 10);\n            Elements.Progress.css('width', progress + '%');\n        },\n        done: function (e, data) {\n            if(data.result.error !== undefined){\n            Elements.Error.html(data.result.error); // выводим на страницу сообщение об ошибке если оно есть        \n            Elements.Error.fadeIn('slow');\n            }else{\n                 Elements.Error.hide(); //на случай если сообщение об ошибке уже отображалось\n                 Elements.Files.append(\"<img class='img-polaroid' style='margin-left:15%;padding:10px;width:auto;height:250px' src=''>\");\n                    $('#success').fadeIn('slow');\n                }\n        }\n    }); \n    */\n    /*\n    Elements.Upload.fileupload({\n        \n        dataType: 'json',\n        \n        add: function (e, data) {\n            data.context = $('<button/>').text('Upload')\n                .appendTo(Elements.Files)\n                .click(function () {\n                    data.context = $('<p/>').text('Uploading...').replaceAll($(this));\n                    Elements.Progress.css(\n                        'width', '0%');\n                    data.submit();\n                });\n        },\n        \n        done: function (e, data) {\n            data.context.text('Upload finished.');\n        },\n        \n        progressall: function (e, data) {\n            var progress = parseInt(data.loaded / data.total * 100, 10);\n            Elements.Progress.css(\n                'width',\n                progress + '%'\n            );\n        },\n        \n    });*/\n}","server":""}