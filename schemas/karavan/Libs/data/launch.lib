{"script":true,"acl":"*","sandbox":"{\n  App: App,\n  require: require,\n  console: console\n}","src":"return function(render) {\n  \n  // Получить список всех библиотек\n  App.Libs.Box.list((err, list) => {\n    if (err) {return render(null, '/* Empty list */');}\n    \n    var list = Object.keys(list);\n    list.sort();\n\n    // Для каждой библиотеки\n    var arr_fn = [];\n    \n    //for (var key in list) {\n    var myPage = config.page;\n    \n    list.forEach((key) => {\n      if (key.substr(0, myPage.length+1) === myPage+'.') {\n          \n          // Если библиотека удовлетворяет требованиям\n          arr_fn.push((function(name){ return function (cb) {\n            \n            App.Libs.content(config.ssid, name, {ssid: config.ssid, name: name}, {}, (err, data) => {\n                if (err) {return cb(null, {name: name, content: ''});}\n    \t\t\treturn cb(null, {name: name, content: data});\n    \t\t});\n            \n          };})(key));\n      }\n    });\n    \n    \n    var async = require('async');\n    async.parallel(arr_fn, (err, data) => {\n        var content = '';\n        data.forEach((item)=>{\n          content += '/* Lib: '+item.name+' */\\n'+item.content+'\\n\\n';\n        });\n        //console.log('Async Result', err, data, content);\n        render(null, content);\n    });\n   \n\n  });  \n}"}